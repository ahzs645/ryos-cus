import{r,j as t}from"./ui-core-D0pDhx0h.js";import{P as ut,S as dt,R as pt,b as mt,D as ht,G as _e,d as xt,e as vt,B as yt,A as bt,f as gt,c as me,g as wt}from"./audio-DxkJfdUY.js";import{u as et,a as tt,M as jt,b as ge,d as we,e as je,f as re,g as Xe,k as Ne,S as Nt,l as kt,m as Ct,n as Pt,o as St,br as Rt,bs as Ie,E as Et,Z as It,aD as Mt,a4 as v,s as $e,t as Je,v as Qe,w as Ye,x as he,B as xe,bt as p,H as At,J as Dt,bu as zt,I as Lt,bv as Tt}from"./index-DMj1es94.js";import{S as Kt,b as Ot,W as qt,P as Ht,a as Bt,c as ke,M as Ut,A as Ft}from"./three-BOJBN814.js";import{A as Me,m as Ae}from"./motion-DC7C-474.js";import"./react-CyQK0IK8.js";import"./media-player-Dfptv93o.js";import"./zustand-CwjPl1Tm.js";import"./tiptap-CPHiBm_b.js";import"./ui-form-Bg85K0S3.js";import"./pusher-BvD42uFZ.js";import"./hangul-CIZ_Rl7P.js";function Gt({onAddPreset:o,onShowHelp:f,onShowAbout:y,onReset:j,onClose:b,presets:g,currentPresetId:E,onLoadPresetById:d,labelType:R,onLabelTypeChange:D}){var U;const{t:u}=et(),[m,w]=r.useState(!1),k="synth",I=(U=Ct[k])==null?void 0:U.name,B=tt(h=>h.current),M=B==="xp"||B==="win98";return t.jsxs(jt,{inWindowFrame:M,children:[t.jsxs(ge,{children:[t.jsx(we,{className:"text-md px-2 py-1 border-none focus-visible:ring-0",children:u("common.menu.file")}),t.jsxs(je,{align:"start",sideOffset:1,className:"px-0",children:[t.jsx(re,{onClick:o,className:"text-md h-6 px-3",children:u("apps.synth.menu.newPreset")}),t.jsx(re,{onClick:j,className:"text-md h-6 px-3",children:u("apps.synth.menu.resetSynth")}),t.jsx(Xe,{className:"h-[2px] bg-black my-1"}),t.jsx(re,{onClick:b,className:"text-md h-6 px-3",children:u("common.menu.close")})]})]}),t.jsxs(ge,{children:[t.jsx(we,{className:"text-md px-2 py-1 border-none focus-visible:ring-0",children:u("apps.synth.menu.presets")}),t.jsx(je,{align:"start",sideOffset:1,className:"px-0",children:g.map(h=>t.jsx(Ne,{checked:E===h.id,onCheckedChange:F=>{F&&d(h.id)},className:"text-md h-6 px-3",children:h.name},h.id))})]}),t.jsxs(ge,{children:[t.jsx(we,{className:"text-md px-2 py-1 border-none focus-visible:ring-0",children:u("common.menu.view")}),t.jsxs(je,{align:"start",sideOffset:1,className:"px-0",children:[t.jsx(Ne,{checked:R==="note",onCheckedChange:h=>{h&&D("note")},className:"text-md h-6 px-3",children:u("apps.synth.menu.noteLabels")}),t.jsx(Ne,{checked:R==="key",onCheckedChange:h=>{h&&D("key")},className:"text-md h-6 px-3",children:u("apps.synth.menu.keyLabels")}),t.jsx(Ne,{checked:R==="off",onCheckedChange:h=>{h&&D("off")},className:"text-md h-6 px-3",children:u("apps.synth.menu.noLabels")})]})]}),t.jsxs(ge,{children:[t.jsx(we,{className:"px-2 py-1 text-md focus-visible:ring-0",children:u("common.menu.help")}),t.jsxs(je,{align:"start",sideOffset:1,className:"px-0",children:[t.jsx(re,{onClick:f,className:"text-md h-6 px-3",children:u("apps.synth.menu.synthHelp")}),t.jsx(re,{onSelect:()=>w(!0),className:"text-md h-6 px-3",children:u("common.menu.shareApp")}),t.jsx(Xe,{className:"h-[2px] bg-black my-1"}),t.jsx(re,{onClick:y,className:"text-md h-6 px-3",children:u("apps.synth.menu.aboutSynth")})]})]}),t.jsx(Nt,{isOpen:m,onClose:()=>w(!1),itemType:"App",itemIdentifier:k,title:I,generateShareUrl:kt})]})}const Vt=({analyzer:o})=>{const f=r.useRef(null),y=r.useRef(null),j=r.useRef(null),b=r.useRef(null),g=r.useRef(null),E=r.useRef(null),d=r.useRef(null),[R,D]=r.useState(!1),u=r.useRef(0),m=r.useRef(0);return r.useEffect(()=>{const w=()=>{D(window.innerWidth<768)};return w(),window.addEventListener("resize",w),()=>{window.removeEventListener("resize",w)}},[]),r.useEffect(()=>{if(!f.current||R)return;const w=new Kt;y.current=w;const k=new Ot(30,f.current.clientWidth/f.current.clientHeight,.1,1e3);k.position.set(0,1.5,2),k.lookAt(0,0,0),j.current=k;const I=new qt({antialias:!0,alpha:!0,powerPreference:"high-performance"});I.setSize(f.current.clientWidth,f.current.clientHeight),I.setPixelRatio(window.devicePixelRatio),f.current.appendChild(I.domElement),b.current=I;const B=new Ht(6,2,96,32),M=`
      varying vec2 vUv;
      varying float vElevation;
      
      void main() {
        vUv = uv;
        vElevation = position.y;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,U=`
      uniform vec3 uColorLow;
      uniform vec3 uColorHigh;
      uniform float uTime;
      uniform float uAmplitude;
      
      varying vec2 vUv;
      varying float vElevation;
      
      void main() {
        // Calculate base color by mixing low and high colors based on elevation
        vec3 color = mix(uColorLow, uColorHigh, abs(vElevation) * 2.0);
        
        // Add wave effect
        float wave = sin(vUv.x * 20.0 + uTime * 2.0) * 0.05 * uAmplitude;
        color += wave;
        
        // Add pulse effect based on amplitude
        float pulse = sin(uTime * 3.0) * 0.15 * uAmplitude;
        color += pulse;
        
        // Add glow effect
        float glow = pow(abs(vElevation) * 3.0, 2.0) * uAmplitude;
        color += vec3(glow * 0.5, glow * 0.3, glow * 0.7);
        
        // Add center brightness - brighten the middle part
        float centerX = abs(vUv.x - 0.5) * 2.0; // 0 at center, 1 at edges
        float centerEffect = (1.0 - centerX) * 0.4; // Stronger in the middle
        color += vec3(centerEffect);
        
        // Ensure minimum brightness
        color = max(color, vec3(0.2, 0.1, 0.3));
        
        gl_FragColor = vec4(color, 0.8);
      }
    `,h=new Bt({uniforms:{uColorLow:{value:new ke(2752592)},uColorHigh:{value:new ke(16711935)},uTime:{value:0},uAmplitude:{value:0}},vertexShader:M,fragmentShader:U,transparent:!0,wireframe:!0});d.current=h;const F=new Ut(B,h);F.rotation.x=-Math.PI/6,w.add(F),g.current=F;const $=new Ft(4210752);w.add($);const ce=()=>{if(!(!g.current||!b.current||!y.current||!j.current||!d.current)){if(u.current+=.01,d.current.uniforms.uTime.value=u.current,o){const z=o.getValue(),G=g.current.geometry.attributes.position.array;let le=0;for(let Q=0;Q<G.length;Q+=3){const W=G[Q],Y=Math.floor((W+3)/6*z.length);if(Y>=0&&Y<z.length){const ee=z[Y];G[Q+1]=Math.abs(ee)>.1?ee*1:0,le=Math.max(le,Math.abs(ee))}}m.current=m.current*.9+le*.1,d.current.uniforms.uAmplitude.value=m.current;const oe=u.current*.1%1,ve=.7+m.current*.3,ie=.5+m.current*.2,q=new ke().setHSL(oe,ve,ie);d.current.uniforms.uColorHigh.value=q;const Ce=new ke().setHSL((oe+.5)%1,ve*.7,ie*.4);d.current.uniforms.uColorLow.value=Ce,g.current.geometry.attributes.position.needsUpdate=!0}b.current.render(y.current,j.current),E.current=requestAnimationFrame(ce)}};ce();const J=()=>{if(!f.current||!j.current||!b.current)return;const z=f.current.clientWidth,G=f.current.clientHeight;j.current.aspect=z/G,j.current.updateProjectionMatrix(),b.current.setSize(z,G),b.current.setPixelRatio(window.devicePixelRatio)},Z=new ResizeObserver(J);return f.current&&Z.observe(f.current),()=>{Z.disconnect(),E.current!==null&&(cancelAnimationFrame(E.current),E.current=null),b.current&&b.current.dispose(),d.current&&d.current.dispose(),g.current&&g.current.geometry&&g.current.geometry.dispose(),f.current&&b.current&&f.current.removeChild(b.current.domElement)}},[o,R]),t.jsx("div",{ref:f,className:"w-full h-12 md:h-28 overflow-hidden bg-black/50 hidden md:block flex-grow"})},Ze=(o,f)=>{const y=o.match(/([A-G]#?)(\d+)/);if(!y)return o;const[,j,b]=y,g=parseInt(b)+f;return g<0||g>8?o:`${j}${g}`},_t=({message:o})=>t.jsx(Me,{children:o&&t.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.2},className:"absolute bottom-4 w-full text-center left-1/2 transform -translate-x-1/2 px-4 py-2 bg-black/80 backdrop-blur-sm text-[#ff00ff] text-[12px] font-geneva-12 z-10 select-none",children:o})}),We=({note:o,isBlack:f=!1,isPressed:y=!1,onPointerDownKey:j,onPointerEnterKey:b,onPointerUpKey:g,labelType:E,keyMap:d,isSystem7Theme:R=!1})=>{const u=(()=>{var m;if(E==="off")return"";if(E==="key"){const w=(m=Object.entries(d).find(([,k])=>k===o))==null?void 0:m[0];return w?w.toUpperCase():""}return o})();return t.jsx("button",{type:"button","data-note":o,className:v("piano-key relative touch-none select-none outline-none transition-colors duration-100",R&&"system7-square",f?v("absolute top-0 left-[65%] w-[74%] h-[70%] rounded-b-md z-10",y?"bg-[#ff33ff]":"bg-black hover:bg-[#333333]"):v("h-full w-full border border-[#333333] rounded-b-md",y?"bg-[#ff33ff]":"bg-white hover:bg-[#f5f5f5]")),onPointerDown:m=>j(o,m),onPointerEnter:m=>b(o,m),onPointerUp:m=>g(o,m),onContextMenu:m=>m.preventDefault(),children:u&&t.jsx("span",{className:v("absolute bottom-2 left-1/2 transform -translate-x-1/2 text-[10px] pointer-events-none font-geneva-12 select-none",f?"text-white":"text-black"),children:u})})};function rs({isWindowOpen:o,onClose:f,isForeground:y,skipInitialSound:j,instanceId:b,onNavigateNext:g,onNavigatePrevious:E}){const d=r.useRef(null),R=r.useRef(null),D=r.useRef(null),u=r.useRef(null),m=r.useRef(null),w=r.useRef(null),k=r.useRef(null),I=r.useRef(null),B=r.useRef(null),M=r.useRef({}),U=r.useRef(0),[h,F]=r.useState(!1),[$,ce]=r.useState(!1),[J,Z]=r.useState(!1),[z,G]=r.useState(!0),[le,oe]=r.useState(""),[ve,ie]=r.useState(""),[q,Ce]=r.useState(!1),[Q,W]=r.useState(0);r.useEffect(()=>{U.current=Q},[Q]);const Y=r.useRef(y);r.useEffect(()=>{Y.current=y},[y]);const[ee,ye]=r.useState({}),[De,H]=r.useState({}),L=r.useRef({});r.useEffect(()=>{L.current=De},[De]);const{play:Pe}=Pt(St.CLICK),ze=["C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5"],st=["C#3","D#3",null,"F#3","G#3","A#3",null,"C#4","D#4",null,"F#4","G#4","A#4",null,"C#5","D#5",null,"F#5"],[Se,nt]=r.useState(8),te=r.useRef(null);r.useEffect(()=>{if(!o)return;const e=()=>{if(!te.current)return;const n=te.current.clientWidth,a=Math.floor((n-400)/80);nt(Math.max(0,Math.min(10,a)))};e();const s=new ResizeObserver(e);return te.current&&s.observe(te.current),()=>{s.disconnect()}},[o,te.current]);const Le=7,at=Math.floor(Se/2),rt=Math.ceil(Se/2),Te=Math.max(0,Le-at),Ke=Math.min(ze.length,Le+8+rt),ct=ze.slice(Te,Ke),Oe=st.slice(Te,Ke),qe=Rt("(max-width: 768px)"),{labelType:Re,setLabelType:He,presets:C,setPresets:fe,currentPreset:l,setCurrentPreset:se}=Ie();r.useEffect(()=>{o&&qe&&He("off")},[qe,o]),r.useEffect(()=>{if(!o)return;const e=new ut(dt),s=new pt({decay:2,wet:l.effects.reverb}),n=new mt({delayTime:.25,feedback:l.effects.delay}),a=new ht({distortion:l.effects.distortion}),i=new _e(l.effects.gain),x=new xt({frequency:4,delayTime:2.5,depth:.7}).start();x.wet.value=l.effects.chorus??0;const S=new vt({frequency:.5,octaves:3,baseFrequency:1e3,wet:l.effects.phaser??0}),ae=new yt(4).set({bits:Math.floor(4+(1-(l.effects.bitcrusher??0))*12)}),Ve=new _e(4),Ee=new bt({type:"waveform",size:1024,smoothing:.8});return e.connect(s),s.connect(n),n.connect(a),a.connect(x),x.connect(S),S.connect(ae),ae.connect(i),i.connect(Ve),Ve.connect(Ee),i.connect(gt),e.set({oscillator:{type:l.oscillator.type},envelope:{attack:l.envelope.attack,decay:l.envelope.decay,sustain:l.envelope.sustain,release:l.envelope.release}}),d.current=e,R.current=s,D.current=n,u.current=a,w.current=i,k.current=x,I.current=S,B.current=ae,m.current=Ee,ne(l),document.addEventListener("keydown",Ue),document.addEventListener("keyup",Fe),()=>{e.dispose(),s.dispose(),n.dispose(),a.dispose(),x.dispose(),S.dispose(),ae.dispose(),i.dispose(),Ee.dispose(),document.removeEventListener("keydown",Ue),document.removeEventListener("keyup",Fe)}},[o]);const ne=e=>{!d.current||!R.current||!D.current||!u.current||!w.current||!k.current||!I.current||!B.current||(d.current.set({oscillator:{type:e.oscillator.type},envelope:{attack:e.envelope.attack,decay:e.envelope.decay,sustain:e.envelope.sustain,release:e.envelope.release}}),R.current.wet.value=e.effects.reverb,D.current.feedback.value=e.effects.delay,u.current.distortion=e.effects.distortion,w.current.gain.value=e.effects.gain,k.current.wet&&(k.current.wet.value=e.effects.chorus??0),I.current.wet&&(I.current.wet.value=e.effects.phaser??0),B.current.set({bits:Math.floor(4+(1-(e.effects.bitcrusher??0))*12)}))},be={a:"C4",w:"C#4",s:"D4",e:"D#4",d:"E4",f:"F4",t:"F#4",g:"G4",y:"G#4",h:"A4",u:"A#4",j:"B4",k:"C5",o:"C#5",l:"D5",p:"D#5",";":"E5","'":"F5"},ue=r.useCallback(e=>{if(!d.current)return;const s=Ze(e,U.current);M.current[e]=s;const n=me.currentTime;d.current.triggerAttack(s,n),ye(a=>({...a,[e]:!0}))},[]),A=r.useCallback(e=>{if(!d.current)return;const s=M.current[e]??Ze(e,U.current),n=me.currentTime;d.current.triggerRelease(s,n),delete M.current[e],ye(a=>({...a,[e]:!1}))},[]),T=r.useCallback(()=>{if(!d.current){M.current={},ye({}),H({});return}const e=me.currentTime,s=Object.keys(M.current);for(const n of s){const a=M.current[n];a&&d.current.triggerRelease(a,e)}M.current={},ye({}),H({})},[]),V=e=>{ie(e),setTimeout(()=>ie(""),3e3)},Be=()=>{G(!0),oe(""),Z(!0),Pe()},lt=e=>{if(z){const s={...l,id:Date.now().toString(),name:e};fe(n=>[...n,s]),se(s),V(c("apps.synth.status.presetSaved",{name:e}))}else{const s={...l,name:e};fe(n=>n.map(a=>a.id===l.id?s:a)),se(s),V(c("apps.synth.status.presetUpdated",{name:e}))}Z(!1)},de=e=>{se(e),ne(e),V(c("apps.synth.status.presetLoaded",{name:e.name})),Pe()},ot=()=>{Ie.getState().reset();const e=Ie.getState().currentPreset;ne(e),V(c("apps.synth.status.synthResetToDefaults")),Pe()},it=e=>{const s={...l,oscillator:{type:e}};se(s),ne(s);const n=C.map(a=>a.id===s.id?s:a);fe(n)},_=(e,s)=>{const n={...l,envelope:{...l.envelope,[e]:s}};se(n),ne(n);const a=C.map(i=>i.id===n.id?n:i);fe(a)},N=(e,s)=>{const n={...l,effects:{...l.effects,[e]:s}};se(n),ne(n);const a=C.map(i=>i.id===n.id?n:i);fe(a)},Ue=e=>{if(!Y.current||e.repeat||J||h||$||q)return;e.key==="-"||e.key==="_"?(e.preventDefault(),W(a=>{const i=Math.max(-2,a-1);return V(c("apps.synth.status.octave",{offset:i})),i})):(e.key==="="||e.key==="+")&&(e.preventDefault(),W(a=>{const i=Math.min(2,a+1);return V(c("apps.synth.status.octave",{offset:i})),i}));const s=parseInt(e.key);if(!isNaN(s)&&s>=1&&s<=9){e.preventDefault();const a=s-1;a<C.length&&de(C[a])}if(e.key==="0"){e.preventDefault();const a=9;a<C.length&&de(C[a])}const n=be[e.key.toLowerCase()];n&&(e.preventDefault(),ue(n))},Fe=e=>{if(!Y.current||J||h||$||q)return;const s=be[e.key.toLowerCase()];s&&(e.preventDefault(),A(s))};r.useEffect(()=>{const e=()=>{document.hidden&&T()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[T]),r.useEffect(()=>{o&&(y||T())},[y,o,T]),r.useEffect(()=>{o&&(q||h||$||J)&&T()},[q,h,$,J,o,T]),r.useEffect(()=>{if(!o)return;const e=()=>T();return window.addEventListener("blur",e),()=>window.removeEventListener("blur",e)},[o,T]),r.useEffect(()=>{o||T()},[o,T]),r.useEffect(()=>{try{wt&&me&&(me.lookAhead=0)}catch{}},[]),r.useEffect(()=>{if(!o)return;const e=s=>{const n=s.pointerId,a=L.current[n];a&&(A(a),H(i=>{const x={...i};return delete x[n],x}))};return window.addEventListener("pointerup",e),window.addEventListener("pointercancel",e),()=>{window.removeEventListener("pointerup",e),window.removeEventListener("pointercancel",e)}},[o,A]);const{t:c}=et(),ft=Et("synth",Tt),pe=tt(e=>e.current),X=pe==="xp"||pe==="win98",K=pe==="system7",P=pe==="macosx"||X,O=pe==="macosx",Ge=t.jsx(Gt,{onAddPreset:Be,onShowHelp:()=>F(!0),onShowAbout:()=>ce(!0),onReset:ot,onClose:f,presets:C,currentPresetId:l.id,onLoadPresetById:e=>{const s=C.find(n=>n.id===e);s&&de(s)},labelType:Re,onLabelTypeChange:He});return o?t.jsxs(t.Fragment,{children:[!X&&y&&Ge,t.jsx(It,{title:Mt("synth"),onClose:f,isForeground:y,appId:"synth",skipInitialSound:j,instanceId:b,onNavigateNext:g,onNavigatePrevious:E,menuBar:X?Ge:void 0,children:t.jsxs("div",{ref:te,className:"flex flex-col h-full w-full bg-[#1a1a1a] text-white overflow-hidden select-none synth-force-font",children:[t.jsxs("div",{className:"flex flex-col flex-1 min-h-0 w-full overflow-hidden",children:[t.jsx("div",{className:v("p-4 py-4 pb-3 bg-[#2a2a2a] w-full border-b border-[#3a3a3a] z-[50] relative","os-toolbar-texture"),children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex gap-0",children:[t.jsx("div",{className:"md:hidden w-48",children:t.jsxs($e,{value:l.id,onValueChange:e=>{const s=C.find(n=>n.id===e);s&&de(s)},children:[t.jsx(Je,{className:v("w-full h-[22px] font-geneva-12 text-[12px] p-2",P&&"text-black bg-transparent",!P&&"bg-black border-[#3a3a3a] text-white"),children:t.jsx(Qe,{placeholder:c("apps.synth.selectPreset")})}),t.jsx(Ye,{className:v(P&&"text-black",!P&&"bg-black border-[#3a3a3a] text-white"),children:C.map(e=>t.jsx(he,{value:e.id,className:v("font-geneva-12 text-[12px] select-none",P&&"text-black"),children:e.name},e.id))})]})}),t.jsx("div",{className:v("hidden md:flex gap-0",O&&"aqua-select-group"),children:C.length>0?C.map(e=>t.jsx(xe,{variant:O?"aqua_select":K?"player":"default","data-state":l.id===e.id?"on":"off",onClick:()=>de(e),className:v("h-[22px] px-2 whitespace-nowrap uppercase select-none",X&&"text-black"),children:e.name},e.id)):t.jsx("p",{className:"text-xs text-gray-400 font-geneva-12 select-none",children:c("apps.synth.noPresetsYet")})})]}),t.jsxs("div",{className:v("flex gap-0",O&&"aqua-select-group"),children:[t.jsx(xe,{variant:O?"aqua_select":K?"player":"default",onClick:()=>W(e=>{const s=Math.max(-2,e-1);return V(c("apps.synth.status.octave",{offset:s})),s}),className:v(K?"h-[22px] px-2":O?"aqua-compact":"h-[22px] px-2",X&&"text-black","select-none"),children:"<"}),t.jsx(xe,{variant:O?"aqua_select":K?"player":"default",onClick:()=>W(e=>{const s=Math.min(2,e+1);return V(c("apps.synth.status.octave",{offset:s})),s}),className:v(K?"h-[22px] px-2":O?"aqua-compact":"h-[22px] px-2",X&&"text-black","select-none"),children:">"}),t.jsx(xe,{variant:O?"aqua_select":K?"player":"default",onClick:()=>Ce(!q),className:v(K?"h-[22px] px-2":O?"aqua-compact font-geneva-12 !text-[11px]":"h-[22px] px-2",X&&"text-black","select-none"),children:c("apps.synth.controls")})]})]})}),t.jsx("div",{className:"relative w-full",children:t.jsx(Me,{children:q&&t.jsx(Ae.div,{initial:{y:-40,opacity:0},animate:{y:0,opacity:1},exit:{y:-40,opacity:0},transition:{type:"spring",stiffness:300,damping:25,mass:.8},className:"absolute top-0 inset-x-0 w-full bg-neutral-900/90 backdrop-blur-xl p-4 z-[40] select-none",children:t.jsxs("div",{className:"flex flex-col md:flex-row md:flex-wrap md:items-start gap-6",children:[t.jsxs("div",{className:"md:min-w-[200px] md:flex-grow md:flex-1 md:flex-basis-0",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("h3",{className:"font-semibold text-[#ff00ff] font-geneva-12 text-[10px] select-none",children:c("apps.synth.oscillator")}),t.jsx(xe,{variant:O?"aqua_select":K?"player":"default",onClick:Be,className:v("h-[22px] px-2 text-[9px] select-none",X&&"text-black"),children:c("apps.synth.addPreset")})]}),t.jsxs($e,{value:l.oscillator.type,onValueChange:e=>it(e),children:[t.jsx(Je,{className:v("w-full font-geneva-12 text-[12px] p-2",P&&"text-black",!P&&"bg-black border-[#3a3a3a] text-white"),children:t.jsx(Qe,{placeholder:c("apps.synth.waveform")})}),t.jsxs(Ye,{className:v(P&&"text-black",!P&&"bg-black border-[#3a3a3a] text-white"),children:[t.jsx(he,{value:"sine",className:v("font-geneva-12 text-[12px]",P&&"text-black"),children:c("apps.synth.waveforms.sine")}),t.jsx(he,{value:"square",className:v("font-geneva-12 text-[12px]",P&&"text-black"),children:c("apps.synth.waveforms.square")}),t.jsx(he,{value:"triangle",className:v("font-geneva-12 text-[12px]",P&&"text-black"),children:c("apps.synth.waveforms.triangle")}),t.jsx(he,{value:"sawtooth",className:v("font-geneva-12 text-[12px]",P&&"text-black"),children:c("apps.synth.waveforms.sawtooth")})]})]}),t.jsx(Me,{children:q&&t.jsx(Ae.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"hidden md:block w-full",children:t.jsx("div",{className:"w-full",children:t.jsx(Vt,{analyzer:m.current})})})})]}),t.jsx("div",{className:"md:hidden overflow-x-auto",children:t.jsxs("div",{className:"flex flex-nowrap gap-6 min-w-max pb-2",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-2 text-[#ff00ff] font-geneva-12 text-[10px] select-none",children:c("apps.synth.envelope")}),t.jsxs("div",{className:"flex flex-nowrap gap-1",children:[t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.envelope.attack,min:.01,max:2,step:.01,onChange:e=>_("attack",e),label:c("apps.synth.envelopeParams.attack"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.envelope.decay,min:.01,max:2,step:.01,onChange:e=>_("decay",e),label:c("apps.synth.envelopeParams.decay"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.envelope.sustain,min:0,max:1,step:.01,onChange:e=>_("sustain",e),label:c("apps.synth.envelopeParams.sustain"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.envelope.release,min:.1,max:4,step:.1,onChange:e=>_("release",e),label:c("apps.synth.envelopeParams.release"),color:"#ff00ff",size:"sm"})})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-2 text-[#ff00ff] font-geneva-12 text-[10px] select-none",children:c("apps.synth.effects")}),t.jsxs("div",{className:"flex flex-nowrap gap-1",children:[t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.effects.gain,min:0,max:1,step:.01,onChange:e=>N("gain",e),label:c("apps.synth.effectsParams.gain"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.effects.reverb,min:0,max:1,step:.01,onChange:e=>N("reverb",e),label:c("apps.synth.effectsParams.reverb"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.effects.delay,min:0,max:1,step:.01,onChange:e=>N("delay",e),label:c("apps.synth.effectsParams.delay"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.effects.distortion,min:0,max:1,step:.01,onChange:e=>N("distortion",e),label:c("apps.synth.effectsParams.distortion"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.effects.chorus??0,min:0,max:1,step:.01,onChange:e=>N("chorus",e),label:c("apps.synth.effectsParams.chorus"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.effects.phaser??0,min:0,max:1,step:.01,onChange:e=>N("phaser",e),label:c("apps.synth.effectsParams.phaser"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16",children:t.jsx(p,{value:l.effects.bitcrusher??0,min:0,max:1,step:.01,onChange:e=>N("bitcrusher",e),label:c("apps.synth.effectsParams.bitcrusher"),color:"#ff00ff",size:"sm"})})]})]})]})}),t.jsxs("div",{className:"hidden md:block md:flex-grow-0 md:flex-shrink-0 md:w-[140px]",children:[t.jsx("h3",{className:"font-semibold mb-2 text-[#ff00ff] font-geneva-12 text-[10px] select-none",children:c("apps.synth.envelope")}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("div",{className:"flex flex-nowrap gap-2 py-0.5 overflow-x-auto",children:[t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.envelope.attack,min:.01,max:2,step:.01,onChange:e=>_("attack",e),label:c("apps.synth.envelopeParams.attack"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.envelope.decay,min:.01,max:2,step:.01,onChange:e=>_("decay",e),label:c("apps.synth.envelopeParams.decay"),color:"#ff00ff",size:"sm"})})]}),t.jsxs("div",{className:"flex flex-nowrap gap-2 py-0.5 overflow-x-auto",children:[t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.envelope.sustain,min:0,max:1,step:.01,onChange:e=>_("sustain",e),label:c("apps.synth.envelopeParams.sustain"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.envelope.release,min:.1,max:4,step:.1,onChange:e=>_("release",e),label:c("apps.synth.envelopeParams.release"),color:"#ff00ff",size:"sm"})})]})]})]}),t.jsxs("div",{className:"hidden md:block md:flex-shrink-0 md:w-[280px]",children:[t.jsx("h3",{className:"font-semibold mb-2 text-[#ff00ff] font-geneva-12 text-[10px] select-none",children:c("apps.synth.effects")}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("div",{className:"flex flex-nowrap gap-2 py-0.5 overflow-x-auto",children:[t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.effects.gain,min:0,max:1,step:.01,onChange:e=>N("gain",e),label:c("apps.synth.effectsParams.gain"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.effects.reverb,min:0,max:1,step:.01,onChange:e=>N("reverb",e),label:c("apps.synth.effectsParams.reverb"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.effects.delay,min:0,max:1,step:.01,onChange:e=>N("delay",e),label:c("apps.synth.effectsParams.delay"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.effects.distortion,min:0,max:1,step:.01,onChange:e=>N("distortion",e),label:c("apps.synth.effectsParams.distortion"),color:"#ff00ff",size:"sm"})})]}),t.jsxs("div",{className:"flex flex-nowrap gap-2 py-0.5 overflow-x-auto",children:[t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.effects.chorus??0,min:0,max:1,step:.01,onChange:e=>N("chorus",e),label:c("apps.synth.effectsParams.chorus"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.effects.phaser??0,min:0,max:1,step:.01,onChange:e=>N("phaser",e),label:c("apps.synth.effectsParams.phaser"),color:"#ff00ff",size:"sm"})}),t.jsx("div",{className:"w-16 flex-shrink-0",children:t.jsx(p,{value:l.effects.bitcrusher??0,min:0,max:1,step:.01,onChange:e=>N("bitcrusher",e),label:c("apps.synth.effectsParams.bitcrusher"),color:"#ff00ff",size:"sm"})})]})]})]})]})})})}),t.jsx("div",{className:"flex-grow flex flex-col justify-end min-h-[160px] bg-black p-4 w-full",children:t.jsxs("div",{className:"relative h-full w-full",children:[t.jsx("div",{className:"absolute inset-0 h-full flex w-full",children:ct.map(e=>t.jsx("div",{className:"flex-1 relative",children:t.jsx(We,{note:e,isPressed:ee[e],onPointerDownKey:(s,n)=>{n.preventDefault();const a=L.current[n.pointerId];a&&a!==s&&A(a),ue(s),H(i=>({...i,[n.pointerId]:s}))},onPointerEnterKey:(s,n)=>{const a=n.pointerType==="mouse"&&(n.buttons&1)===1,i=n.pointerType==="touch"&&L.current[n.pointerId]!==void 0;if(!a&&!i)return;const x=L.current[n.pointerId];x!==s&&(x&&A(x),ue(s),H(S=>({...S,[n.pointerId]:s})))},onPointerUpKey:(s,n)=>{const a=L.current[n.pointerId];a?(A(a),H(i=>{const x={...i};return delete x[n.pointerId],x})):A(s)},labelType:Re,keyMap:be,isSystem7Theme:K})},e))}),t.jsx("div",{className:"absolute inset-0 h-full w-full flex pointer-events-none",children:Oe.map((e,s)=>Se>0&&s===Oe.length-1?t.jsx("div",{className:"flex-1 relative"},`empty-${s}`):t.jsx("div",{className:"flex-1 relative",children:e&&t.jsx("div",{className:"pointer-events-auto w-full",children:t.jsx(We,{note:e,isBlack:!0,isPressed:ee[e],onPointerDownKey:(n,a)=>{a.preventDefault();const i=L.current[a.pointerId];i&&i!==n&&A(i),ue(n),H(x=>({...x,[a.pointerId]:n}))},onPointerEnterKey:(n,a)=>{const i=a.pointerType==="mouse"&&(a.buttons&1)===1,x=a.pointerType==="touch"&&L.current[a.pointerId]!==void 0;if(!i&&!x)return;const S=L.current[a.pointerId];S!==n&&(S&&A(S),ue(n),H(ae=>({...ae,[a.pointerId]:n})))},onPointerUpKey:(n,a)=>{const i=L.current[a.pointerId];i?(A(i),H(x=>{const S={...x};return delete S[a.pointerId],S})):A(n)},labelType:Re,keyMap:be,isSystem7Theme:K})})},e||`empty-${s}`))})]})})]}),t.jsx(_t,{message:ve})]})}),t.jsx(At,{isOpen:h,onOpenChange:F,helpItems:ft,appId:"synth"}),t.jsx(Dt,{isOpen:$,onOpenChange:ce,metadata:zt,appId:"synth"}),t.jsx(Lt,{isOpen:J,onOpenChange:Z,onSubmit:lt,title:c(z?"apps.synth.dialogs.saveNewPreset":"apps.synth.dialogs.updatePreset"),description:c(z?"apps.synth.dialogs.enterPresetName":"apps.synth.dialogs.updatePresetName"),value:le,onChange:oe})]}):null}export{rs as SynthAppComponent};
